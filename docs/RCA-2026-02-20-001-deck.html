<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RCA-2026-02-20-001 | Market Data Bridge API Outage</title>
<style>
  @page { size: landscape; margin: 0; }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: #0f1117; color: #e4e4e7; }

  .slide {
    width: 100vw; min-height: 100vh; padding: 48px 64px;
    display: flex; flex-direction: column; justify-content: center;
    page-break-after: always; position: relative;
  }
  .slide::after {
    content: attr(data-slide);
    position: absolute; bottom: 24px; right: 48px;
    color: #52525b; font-size: 14px;
  }
  .slide-logo {
    position: absolute; top: 24px; right: 48px;
    color: #52525b; font-size: 12px; font-weight: 600; letter-spacing: 2px;
  }

  h1 { font-size: 42px; font-weight: 700; color: #f4f4f5; margin-bottom: 8px; }
  h2 { font-size: 32px; font-weight: 600; color: #f4f4f5; margin-bottom: 24px; }
  h3 { font-size: 22px; font-weight: 600; color: #a1a1aa; margin-bottom: 16px; }
  .subtitle { font-size: 20px; color: #a1a1aa; margin-bottom: 32px; }

  .meta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 32px; }
  .meta-item { background: #18181b; border: 1px solid #27272a; border-radius: 8px; padding: 16px; }
  .meta-label { font-size: 12px; color: #71717a; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
  .meta-value { font-size: 18px; color: #f4f4f5; font-weight: 500; }
  .meta-value.red { color: #f87171; }
  .meta-value.green { color: #34d399; }
  .meta-value.yellow { color: #fbbf24; }

  table { width: 100%; border-collapse: collapse; margin-top: 16px; font-size: 15px; }
  th { text-align: left; padding: 10px 12px; background: #18181b; color: #a1a1aa; font-weight: 600; border-bottom: 2px solid #27272a; }
  td { padding: 10px 12px; border-bottom: 1px solid #1f1f23; }
  tr:hover td { background: #18181b; }
  .tag { display: inline-block; padding: 2px 10px; border-radius: 9999px; font-size: 12px; font-weight: 600; }
  .tag-red { background: #7f1d1d; color: #fca5a5; }
  .tag-green { background: #064e3b; color: #6ee7b7; }
  .tag-yellow { background: #78350f; color: #fde68a; }
  .tag-blue { background: #1e3a5f; color: #93c5fd; }

  .timeline { margin-top: 16px; }
  .tl-item { display: flex; gap: 16px; padding: 8px 0; border-left: 3px solid #27272a; padding-left: 20px; margin-left: 8px; }
  .tl-item.gap { border-left-color: #ef4444; border-left-style: dashed; }
  .tl-item.fix { border-left-color: #34d399; }
  .tl-time { font-family: 'Cascadia Code', 'Fira Code', monospace; font-size: 13px; color: #71717a; min-width: 180px; flex-shrink: 0; }
  .tl-event { font-size: 14px; }

  /* Ishikawa / Fishbone */
  .ishikawa { width: 100%; margin-top: 24px; }
  .ishikawa svg { width: 100%; height: auto; }

  .five-whys { counter-reset: why; margin-top: 16px; }
  .why { display: flex; gap: 16px; align-items: flex-start; margin-bottom: 12px; padding: 12px 16px; background: #18181b; border-radius: 8px; border-left: 4px solid #3b82f6; }
  .why::before { counter-increment: why; content: "Why #" counter(why); font-weight: 700; color: #60a5fa; min-width: 64px; font-size: 13px; }
  .why-text { font-size: 15px; line-height: 1.5; }
  .why-answer { color: #fbbf24; font-weight: 500; }

  .ca-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
  .ca-card { background: #18181b; border: 1px solid #27272a; border-radius: 8px; padding: 16px; }
  .ca-card.done { border-color: #065f46; }
  .ca-card.open { border-color: #78350f; }
  .ca-id { font-size: 12px; color: #71717a; margin-bottom: 4px; }
  .ca-text { font-size: 14px; font-weight: 500; }
  .ca-owner { font-size: 12px; color: #a1a1aa; margin-top: 8px; }

  .risk-matrix { margin-top: 16px; }
  .risk-row { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 2px; margin-bottom: 2px; }
  .risk-cell { padding: 10px 12px; font-size: 13px; background: #18181b; }
  .risk-cell.header { background: #27272a; color: #a1a1aa; font-weight: 600; }
  .risk-cell.high { color: #f87171; }
  .risk-cell.med { color: #fbbf24; }
  .risk-cell.low { color: #34d399; }

  .lessons { margin-top: 16px; }
  .lesson { background: #18181b; border-radius: 8px; padding: 14px 16px; margin-bottom: 8px; display: flex; gap: 12px; }
  .lesson-id { color: #60a5fa; font-weight: 700; font-size: 13px; min-width: 36px; }
  .lesson-text { font-size: 14px; line-height: 1.5; }
  .lesson-cat { font-size: 11px; color: #71717a; margin-top: 4px; }

  @media print {
    .slide { height: 100vh; overflow: hidden; }
    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  }
</style>
</head>
<body>

<!-- SLIDE 1: Title -->
<div class="slide" data-slide="1 / 10" style="justify-content: center; align-items: center; text-align: center;">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h1>Root Cause Analysis</h1>
  <p class="subtitle">INC-2026-02-20-001 — API Unreachable via Cloudflare Tunnel</p>
  <div style="margin-top: 48px; display: flex; gap: 32px; justify-content: center;">
    <div class="meta-item" style="min-width: 180px;">
      <div class="meta-label">Severity</div>
      <div class="meta-value yellow">Medium</div>
    </div>
    <div class="meta-item" style="min-width: 180px;">
      <div class="meta-label">Duration</div>
      <div class="meta-value red">~2 days (est.)</div>
    </div>
    <div class="meta-item" style="min-width: 180px;">
      <div class="meta-label">Financial Impact</div>
      <div class="meta-value green">None</div>
    </div>
    <div class="meta-item" style="min-width: 180px;">
      <div class="meta-label">Date</div>
      <div class="meta-value">2026-02-20</div>
    </div>
  </div>
  <p style="margin-top: 48px; color: #52525b; font-size: 14px;">Prepared by Claude Code (Agent #2) | Reviewed by Engineering Manager</p>
</div>

<!-- SLIDE 2: Incident Summary -->
<div class="slide" data-slide="2 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Incident Summary</h2>
  <div class="meta-grid">
    <div class="meta-item">
      <div class="meta-label">What Happened</div>
      <div class="meta-value" style="font-size: 16px;">REST API unreachable through Cloudflare Tunnel. ChatGPT CustomGPT received error 1033.</div>
    </div>
    <div class="meta-item">
      <div class="meta-label">Root Cause</div>
      <div class="meta-value" style="font-size: 16px;">PM2 process list was empty. Bridge server was not running. Tunnel had no origin to proxy to.</div>
    </div>
    <div class="meta-item">
      <div class="meta-label">Detected By</div>
      <div class="meta-value">ChatGPT CustomGPT (Agent #4)</div>
    </div>
    <div class="meta-item">
      <div class="meta-label">Resolution</div>
      <div class="meta-value green">pm2 start ecosystem.config.cjs</div>
    </div>
  </div>
  <h3 style="margin-top: 32px;">Impact Assessment</h3>
  <table>
    <tr><th>Area</th><th>Impact</th></tr>
    <tr><td>Trading operations</td><td><span class="tag tag-green">None</span> No open positions during outage</td></tr>
    <tr><td>Data loss</td><td><span class="tag tag-green">None</span> SQLite DB intact</td></tr>
    <tr><td>Financial</td><td><span class="tag tag-green">None</span> Assist-discretion mode, no automated execution</td></tr>
    <tr><td>External integrations</td><td><span class="tag tag-red">Down</span> ChatGPT CustomGPT unable to call API</td></tr>
    <tr><td>MCP tools (Claude Code)</td><td><span class="tag tag-green">None</span> MCP connects to TWS directly</td></tr>
    <tr><td>Monitoring / alerting</td><td><span class="tag tag-red">Gap</span> No system detected the outage</td></tr>
  </table>
</div>

<!-- SLIDE 3: Timeline -->
<div class="slide" data-slide="3 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Timeline</h2>
  <div class="timeline">
    <div class="tl-item">
      <div class="tl-time">Feb 17 19:30 ET</div>
      <div class="tl-event">Last successful health check logged (<code>GET /health/deep → 200</code>)</div>
    </div>
    <div class="tl-item gap">
      <div class="tl-time">Feb 17 19:30 → Feb 18 13:11</div>
      <div class="tl-event" style="color: #f87171; font-weight: 600;">GAP — PM2 processes stopped/deleted (reboot or manual action)</div>
    </div>
    <div class="tl-item">
      <div class="tl-time">Feb 18 13:11 ET</div>
      <div class="tl-event">Bridge restarted manually. Crash loop detected (restart within 2s), then stabilized.</div>
    </div>
    <div class="tl-item gap">
      <div class="tl-time">Feb 18 ~14:00 → Feb 20 10:40</div>
      <div class="tl-event" style="color: #f87171; font-weight: 600;">GAP — PM2 processes stopped/deleted again at unknown time. Estimated 2+ days offline.</div>
    </div>
    <div class="tl-item">
      <div class="tl-time">Feb 20 10:30 ET</div>
      <div class="tl-event">ChatGPT CustomGPT reports Cloudflare error 1033 — tunnel has no origin</div>
    </div>
    <div class="tl-item">
      <div class="tl-time">Feb 20 10:39 ET</div>
      <div class="tl-event">Investigation: cloudflared running (PID 58460), PM2 list empty, port 3000 unbound</div>
    </div>
    <div class="tl-item">
      <div class="tl-time">Feb 20 10:40 ET</div>
      <div class="tl-event">Ran <code>pm2 start ecosystem.config.cjs</code> — EADDRINUSE on first 2 attempts</div>
    </div>
    <div class="tl-item fix">
      <div class="tl-time">Feb 20 10:41 ET</div>
      <div class="tl-event" style="color: #34d399; font-weight: 600;">Bridge stabilized on 3rd attempt. IBKR connected. API responding 200.</div>
    </div>
  </div>
</div>

<!-- SLIDE 4: Ishikawa Fishbone Diagram -->
<div class="slide" data-slide="4 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Ishikawa (Fishbone) Diagram</h2>
  <div class="ishikawa">
    <svg viewBox="0 0 1100 500" xmlns="http://www.w3.org/2000/svg">
      <!-- Spine -->
      <line x1="80" y1="250" x2="1020" y2="250" stroke="#71717a" stroke-width="3"/>
      <!-- Effect box -->
      <rect x="920" y="210" width="180" height="80" rx="8" fill="#7f1d1d" stroke="#f87171" stroke-width="2"/>
      <text x="1010" y="245" fill="#fca5a5" text-anchor="middle" font-size="13" font-weight="700">API Unreachable</text>
      <text x="1010" y="265" fill="#fca5a5" text-anchor="middle" font-size="11">via Cloudflare Tunnel</text>

      <!-- Category 1: People (top-left) -->
      <line x1="230" y1="80" x2="330" y2="250" stroke="#60a5fa" stroke-width="2"/>
      <rect x="120" y="40" width="160" height="36" rx="4" fill="#1e3a5f"/>
      <text x="200" y="64" fill="#93c5fd" text-anchor="middle" font-size="14" font-weight="700">People</text>
      <line x1="160" y1="120" x2="260" y2="190" stroke="#60a5fa" stroke-width="1" stroke-dasharray="4"/>
      <text x="140" y="115" fill="#a1a1aa" font-size="11">No one noticed</text>
      <text x="140" y="130" fill="#a1a1aa" font-size="11">2-day outage</text>
      <line x1="200" y1="90" x2="280" y2="170" stroke="#60a5fa" stroke-width="1" stroke-dasharray="4"/>
      <text x="160" y="85" fill="#a1a1aa" font-size="11">Manual PM2 start</text>
      <text x="160" y="100" fill="#a1a1aa" font-size="11">after every reboot</text>

      <!-- Category 2: Process (top-center) -->
      <line x1="450" y1="80" x2="530" y2="250" stroke="#fbbf24" stroke-width="2"/>
      <rect x="370" y="40" width="160" height="36" rx="4" fill="#78350f"/>
      <text x="450" y="64" fill="#fde68a" text-anchor="middle" font-size="14" font-weight="700">Process</text>
      <line x1="380" y1="110" x2="470" y2="180" stroke="#fbbf24" stroke-width="1" stroke-dasharray="4"/>
      <text x="350" y="105" fill="#a1a1aa" font-size="11">No boot procedure</text>
      <text x="350" y="120" fill="#a1a1aa" font-size="11">documented</text>
      <line x1="420" y1="90" x2="490" y2="160" stroke="#fbbf24" stroke-width="1" stroke-dasharray="4"/>
      <text x="400" y="85" fill="#a1a1aa" font-size="11">No startup checklist</text>

      <!-- Category 3: Technology (top-right) -->
      <line x1="680" y1="80" x2="730" y2="250" stroke="#34d399" stroke-width="2"/>
      <rect x="600" y="40" width="160" height="36" rx="4" fill="#064e3b"/>
      <text x="680" y="64" fill="#6ee7b7" text-anchor="middle" font-size="14" font-weight="700">Technology</text>
      <line x1="620" y1="110" x2="690" y2="180" stroke="#34d399" stroke-width="1" stroke-dasharray="4"/>
      <text x="590" y="105" fill="#a1a1aa" font-size="11">PM2 not a Windows</text>
      <text x="590" y="120" fill="#a1a1aa" font-size="11">service (no persist)</text>
      <line x1="660" y1="90" x2="710" y2="160" stroke="#34d399" stroke-width="1" stroke-dasharray="4"/>
      <text x="640" y="85" fill="#a1a1aa" font-size="11">EADDRINUSE stale</text>
      <text x="640" y="100" fill="#a1a1aa" font-size="11">port on restart</text>

      <!-- Category 4: Environment (bottom-left) -->
      <line x1="230" y1="420" x2="330" y2="250" stroke="#c084fc" stroke-width="2"/>
      <rect x="120" y="430" width="160" height="36" rx="4" fill="#3b0764"/>
      <text x="200" y="454" fill="#d8b4fe" text-anchor="middle" font-size="14" font-weight="700">Environment</text>
      <line x1="160" y1="380" x2="260" y2="310" stroke="#c084fc" stroke-width="1" stroke-dasharray="4"/>
      <text x="120" y="375" fill="#a1a1aa" font-size="11">Windows reboot/logoff</text>
      <text x="120" y="390" fill="#a1a1aa" font-size="11">killed PM2 daemon</text>
      <line x1="200" y1="400" x2="280" y2="330" stroke="#c084fc" stroke-width="1" stroke-dasharray="4"/>
      <text x="160" y="405" fill="#a1a1aa" font-size="11">cloudflared = service</text>
      <text x="160" y="420" fill="#a1a1aa" font-size="11">PM2 = user process</text>

      <!-- Category 5: Monitoring (bottom-center) -->
      <line x1="450" y1="420" x2="530" y2="250" stroke="#fb923c" stroke-width="2"/>
      <rect x="370" y="430" width="160" height="36" rx="4" fill="#7c2d12"/>
      <text x="450" y="454" fill="#fdba74" text-anchor="middle" font-size="14" font-weight="700">Monitoring</text>
      <line x1="380" y1="380" x2="470" y2="310" stroke="#fb923c" stroke-width="1" stroke-dasharray="4"/>
      <text x="340" y="375" fill="#a1a1aa" font-size="11">No external uptime ping</text>
      <line x1="420" y1="400" x2="490" y2="330" stroke="#fb923c" stroke-width="1" stroke-dasharray="4"/>
      <text x="370" y="395" fill="#a1a1aa" font-size="11">Health monitor is internal</text>
      <text x="370" y="410" fill="#a1a1aa" font-size="11">(circular dependency)</text>

      <!-- Category 6: Measurement (bottom-right) -->
      <line x1="680" y1="420" x2="730" y2="250" stroke="#f472b6" stroke-width="2"/>
      <rect x="600" y="430" width="160" height="36" rx="4" fill="#831843"/>
      <text x="680" y="454" fill="#f9a8d4" text-anchor="middle" font-size="14" font-weight="700">Measurement</text>
      <line x1="620" y1="380" x2="690" y2="310" stroke="#f472b6" stroke-width="1" stroke-dasharray="4"/>
      <text x="580" y="375" fill="#a1a1aa" font-size="11">No SLA defined for</text>
      <text x="580" y="390" fill="#a1a1aa" font-size="11">tunnel uptime</text>
      <line x1="660" y1="400" x2="710" y2="330" stroke="#f472b6" stroke-width="1" stroke-dasharray="4"/>
      <text x="620" y="395" fill="#a1a1aa" font-size="11">No MTTR tracking</text>
    </svg>
  </div>
</div>

<!-- SLIDE 5: Five Whys -->
<div class="slide" data-slide="5 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Five Whys Analysis</h2>
  <div class="five-whys">
    <div class="why">
      <div class="why-text">Why was the API unreachable?<br><span class="why-answer">Cloudflare Tunnel had no origin server to proxy to.</span></div>
    </div>
    <div class="why">
      <div class="why-text">Why was there no origin server?<br><span class="why-answer">PM2 process list was empty. The bridge server was not running.</span></div>
    </div>
    <div class="why">
      <div class="why-text">Why was PM2 empty?<br><span class="why-answer">PM2 processes don't persist across Windows reboots/logoffs without explicit save + startup configuration.</span></div>
    </div>
    <div class="why">
      <div class="why-text">Why isn't PM2 persistence configured?<br><span class="why-answer">It was never set up. The system was always manually started after reboots.</span></div>
    </div>
    <div class="why">
      <div class="why-text">Why wasn't the outage detected automatically?<br><span class="why-answer">No external monitoring exists. The only health checks are internal (bridge monitors itself), which can't fire when the bridge is down.</span></div>
    </div>
  </div>
  <div style="margin-top: 32px; padding: 16px; background: #1c1917; border: 1px solid #78350f; border-radius: 8px;">
    <h3 style="color: #fbbf24; margin-bottom: 8px;">Root Cause (confirmed)</h3>
    <p style="font-size: 16px; line-height: 1.6;">Asymmetric service configuration: <code>cloudflared</code> runs as a Windows Service (survives reboot), while PM2 runs as a user-space daemon (does not). A Windows reboot or logoff event killed the PM2 daemon, stopping the bridge, while cloudflared continued serving tunnel requests to a dead origin.</p>
  </div>
</div>

<!-- SLIDE 6: Architecture Failure Diagram -->
<div class="slide" data-slide="6 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Architecture Failure Point</h2>
  <svg viewBox="0 0 900 400" xmlns="http://www.w3.org/2000/svg" style="width: 100%; margin-top: 24px;">
    <!-- Internet -->
    <rect x="30" y="150" width="140" height="70" rx="8" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
    <text x="100" y="182" fill="#93c5fd" text-anchor="middle" font-size="14" font-weight="600">ChatGPT</text>
    <text x="100" y="200" fill="#60a5fa" text-anchor="middle" font-size="11">CustomGPT</text>

    <!-- Arrow 1 -->
    <line x1="170" y1="185" x2="250" y2="185" stroke="#71717a" stroke-width="2" marker-end="url(#arrow)"/>
    <text x="210" y="175" fill="#71717a" text-anchor="middle" font-size="10">HTTPS</text>

    <!-- Cloudflare -->
    <rect x="250" y="150" width="140" height="70" rx="8" fill="#064e3b" stroke="#34d399" stroke-width="2"/>
    <text x="320" y="178" fill="#6ee7b7" text-anchor="middle" font-size="14" font-weight="600">Cloudflare</text>
    <text x="320" y="196" fill="#34d399" text-anchor="middle" font-size="11">Tunnel (Argo)</text>
    <text x="320" y="230" fill="#34d399" text-anchor="middle" font-size="11" font-weight="600">Running as Service</text>

    <!-- Arrow 2 -->
    <line x1="390" y1="185" x2="470" y2="185" stroke="#71717a" stroke-width="2" marker-end="url(#arrow)"/>
    <text x="430" y="175" fill="#71717a" text-anchor="middle" font-size="10">localhost</text>

    <!-- cloudflared -->
    <rect x="470" y="150" width="140" height="70" rx="8" fill="#064e3b" stroke="#34d399" stroke-width="2"/>
    <text x="540" y="178" fill="#6ee7b7" text-anchor="middle" font-size="14" font-weight="600">cloudflared</text>
    <text x="540" y="196" fill="#34d399" text-anchor="middle" font-size="11">PID 58460</text>
    <text x="540" y="232" fill="#34d399" font-size="10" text-anchor="middle">Windows Service</text>
    <circle cx="615" cy="155" r="6" fill="#34d399"/>

    <!-- Arrow 3 — BROKEN -->
    <line x1="610" y1="185" x2="690" y2="185" stroke="#ef4444" stroke-width="3" stroke-dasharray="8,4"/>
    <text x="650" y="175" fill="#f87171" text-anchor="middle" font-size="11" font-weight="700">BROKEN</text>
    <text x="650" y="205" fill="#f87171" text-anchor="middle" font-size="10">:3000 unbound</text>

    <!-- PM2 / Bridge — DOWN -->
    <rect x="690" y="150" width="140" height="70" rx="8" fill="#1c1917" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,3"/>
    <text x="760" y="178" fill="#fca5a5" text-anchor="middle" font-size="14" font-weight="600">PM2 / Bridge</text>
    <text x="760" y="196" fill="#f87171" text-anchor="middle" font-size="11">NOT RUNNING</text>
    <text x="760" y="232" fill="#f87171" font-size="10" text-anchor="middle">User-space daemon</text>
    <circle cx="835" cy="155" r="6" fill="#ef4444"/>

    <!-- Legend -->
    <circle cx="50" y="340" r="6" fill="#34d399"/>
    <text x="62" y="344" fill="#a1a1aa" font-size="12">Survived reboot (OS service)</text>
    <circle cx="50" y="365" r="6" fill="#ef4444"/>
    <text x="62" y="369" fill="#a1a1aa" font-size="12">Did NOT survive reboot (user process)</text>

    <!-- The gap label -->
    <rect x="430" y="280" width="300" height="50" rx="6" fill="#7f1d1d" stroke="#f87171"/>
    <text x="580" y="302" fill="#fca5a5" text-anchor="middle" font-size="13" font-weight="600">Asymmetric reliability:</text>
    <text x="580" y="320" fill="#fca5a5" text-anchor="middle" font-size="12">cloudflared (service) alive, PM2 (user) dead</text>

    <defs><marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" fill="#71717a"/></marker></defs>
  </svg>
</div>

<!-- SLIDE 7: EADDRINUSE Sequence -->
<div class="slide" data-slide="7 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Recovery Sequence — EADDRINUSE</h2>
  <p class="subtitle">Port conflict during restart caused 3 crash loops before stabilization</p>
  <svg viewBox="0 0 900 320" xmlns="http://www.w3.org/2000/svg" style="width: 100%; margin-top: 16px;">
    <!-- Timeline base -->
    <line x1="50" y1="200" x2="850" y2="200" stroke="#27272a" stroke-width="2"/>

    <!-- Attempt 1 -->
    <circle cx="150" cy="200" r="8" fill="#ef4444"/>
    <text x="150" y="230" fill="#f87171" text-anchor="middle" font-size="11" font-weight="600">10:40:20</text>
    <text x="150" y="250" fill="#a1a1aa" text-anchor="middle" font-size="10">Start #1</text>
    <text x="150" y="265" fill="#f87171" text-anchor="middle" font-size="10">EADDRINUSE</text>
    <text x="150" y="280" fill="#71717a" text-anchor="middle" font-size="9">clientId=11</text>
    <rect x="100" y="120" width="100" height="50" rx="4" fill="#7f1d1d"/>
    <text x="150" y="142" fill="#fca5a5" text-anchor="middle" font-size="10">Stale node.exe</text>
    <text x="150" y="158" fill="#fca5a5" text-anchor="middle" font-size="10">holding :3000</text>
    <line x1="150" y1="170" x2="150" y2="192" stroke="#ef4444" stroke-width="1" stroke-dasharray="3"/>

    <!-- Attempt 2 -->
    <circle cx="350" cy="200" r="8" fill="#ef4444"/>
    <text x="350" y="230" fill="#f87171" text-anchor="middle" font-size="11" font-weight="600">10:40:25</text>
    <text x="350" y="250" fill="#a1a1aa" text-anchor="middle" font-size="10">Start #2</text>
    <text x="350" y="265" fill="#f87171" text-anchor="middle" font-size="10">EADDRINUSE</text>
    <text x="350" y="280" fill="#71717a" text-anchor="middle" font-size="9">clientId=8</text>

    <!-- Attempt 3 -->
    <circle cx="550" cy="200" r="8" fill="#ef4444"/>
    <text x="550" y="230" fill="#f87171" text-anchor="middle" font-size="11" font-weight="600">10:40:34</text>
    <text x="550" y="250" fill="#a1a1aa" text-anchor="middle" font-size="10">Start #3</text>
    <text x="550" y="265" fill="#f87171" text-anchor="middle" font-size="10">crash_loop</text>

    <!-- Success -->
    <circle cx="750" cy="200" r="10" fill="#34d399"/>
    <text x="750" y="230" fill="#34d399" text-anchor="middle" font-size="11" font-weight="600">10:41:29</text>
    <text x="750" y="250" fill="#a1a1aa" text-anchor="middle" font-size="10">Start #4</text>
    <text x="750" y="265" fill="#34d399" text-anchor="middle" font-size="10" font-weight="600">SUCCESS</text>
    <text x="750" y="280" fill="#71717a" text-anchor="middle" font-size="9">Port freed</text>
    <rect x="695" y="110" width="110" height="60" rx="4" fill="#064e3b"/>
    <text x="750" y="130" fill="#6ee7b7" text-anchor="middle" font-size="10">IBKR connected</text>
    <text x="750" y="146" fill="#6ee7b7" text-anchor="middle" font-size="10">Reconcile: 0 orders</text>
    <text x="750" y="162" fill="#6ee7b7" text-anchor="middle" font-size="10">All schedulers armed</text>
    <line x1="750" y1="170" x2="750" y2="190" stroke="#34d399" stroke-width="1" stroke-dasharray="3"/>

    <!-- Arrows between attempts -->
    <path d="M 170 195 Q 250 160 340 195" stroke="#71717a" stroke-width="1" fill="none" stroke-dasharray="4"/>
    <text x="250" y="165" fill="#71717a" text-anchor="middle" font-size="9">5s backoff</text>
    <path d="M 370 195 Q 450 160 540 195" stroke="#71717a" stroke-width="1" fill="none" stroke-dasharray="4"/>
    <text x="450" y="165" fill="#71717a" text-anchor="middle" font-size="9">9s backoff</text>
    <path d="M 570 195 Q 650 150 740 195" stroke="#71717a" stroke-width="1" fill="none" stroke-dasharray="4"/>
    <text x="650" y="155" fill="#71717a" text-anchor="middle" font-size="9">55s backoff</text>
  </svg>
  <div style="margin-top: 16px; padding: 12px 16px; background: #18181b; border-radius: 8px; border-left: 4px solid #fbbf24;">
    <p style="font-size: 14px;"><strong style="color: #fbbf24;">Contributing factor:</strong> A stale <code>node.exe</code> from a previous manual <code>npm start</code> was holding port 3000. PM2's exponential backoff retry eventually succeeded after the stale process released the port. <strong>Enforce: all production runs go through PM2, never bare <code>npm start</code>.</strong></p>
  </div>
</div>

<!-- SLIDE 8: Corrective Actions -->
<div class="slide" data-slide="8 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Corrective Actions</h2>
  <h3>Immediate (completed)</h3>
  <div class="ca-grid" style="grid-template-columns: 1fr 1fr 1fr;">
    <div class="ca-card done">
      <div class="ca-id">CA-1</div>
      <div class="ca-text">Restarted bridge via PM2</div>
      <div class="ca-owner"><span class="tag tag-green">Done</span> Claude Code</div>
    </div>
    <div class="ca-card done">
      <div class="ca-id">CA-2</div>
      <div class="ca-text">Verified API responding (200)</div>
      <div class="ca-owner"><span class="tag tag-green">Done</span> Claude Code</div>
    </div>
    <div class="ca-card done">
      <div class="ca-id">CA-3</div>
      <div class="ca-text">Verified IBKR connected (live)</div>
      <div class="ca-owner"><span class="tag tag-green">Done</span> Claude Code</div>
    </div>
  </div>
  <h3 style="margin-top: 24px;">Short-term (this week — target Feb 24)</h3>
  <div class="ca-grid">
    <div class="ca-card open">
      <div class="ca-id">CA-4</div>
      <div class="ca-text">Configure PM2 startup persistence on Windows (pm2 save + Windows service)</div>
      <div class="ca-owner"><span class="tag tag-yellow">Open</span> Amazon Q (#14) / Copilot (#5)</div>
    </div>
    <div class="ca-card open">
      <div class="ca-id">CA-5</div>
      <div class="ca-text">Add external uptime ping (UptimeRobot free tier → tunnel /health/ready)</div>
      <div class="ca-owner"><span class="tag tag-yellow">Open</span> Human</div>
    </div>
    <div class="ca-card open">
      <div class="ca-id">CA-6</div>
      <div class="ca-text">Document boot procedure in ops runbook</div>
      <div class="ca-owner"><span class="tag tag-yellow">Open</span> Copilot (#5)</div>
    </div>
  </div>
  <h3 style="margin-top: 24px;">Long-term (this quarter)</h3>
  <div class="ca-grid" style="grid-template-columns: 1fr 1fr 1fr;">
    <div class="ca-card open">
      <div class="ca-id">CA-7</div>
      <div class="ca-text">Dead-man's-switch: alert if no heartbeat for 10min</div>
      <div class="ca-owner"><span class="tag tag-blue">Q1</span> Claude Code (#2)</div>
    </div>
    <div class="ca-card open">
      <div class="ca-id">CA-8</div>
      <div class="ca-text">Add PM2 process count to ops_health MCP tool</div>
      <div class="ca-owner"><span class="tag tag-blue">Q1</span> Claude Code (#2)</div>
    </div>
    <div class="ca-card open">
      <div class="ca-id">CA-9</div>
      <div class="ca-text">Migrate PM2 to Windows Service (nssm/node-windows)</div>
      <div class="ca-owner"><span class="tag tag-blue">Q2</span> Amazon Q (#14)</div>
    </div>
  </div>
</div>

<!-- SLIDE 9: Risk Re-Assessment -->
<div class="slide" data-slide="9 / 10">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h2>Risk Re-Assessment</h2>
  <div class="risk-matrix" style="margin-top: 32px;">
    <div class="risk-row">
      <div class="risk-cell header">Risk</div>
      <div class="risk-cell header">Before</div>
      <div class="risk-cell header">Current</div>
      <div class="risk-cell header">After CAs</div>
    </div>
    <div class="risk-row">
      <div class="risk-cell">Bridge down, undetected</div>
      <div class="risk-cell high">HIGH</div>
      <div class="risk-cell high">HIGH</div>
      <div class="risk-cell low">LOW</div>
    </div>
    <div class="risk-row">
      <div class="risk-cell">PM2 lost on reboot</div>
      <div class="risk-cell high">HIGH</div>
      <div class="risk-cell high">HIGH</div>
      <div class="risk-cell low">LOW</div>
    </div>
    <div class="risk-row">
      <div class="risk-cell">Stale port conflict on restart</div>
      <div class="risk-cell med">MEDIUM</div>
      <div class="risk-cell med">MEDIUM</div>
      <div class="risk-cell low">LOW</div>
    </div>
    <div class="risk-row">
      <div class="risk-cell">External API consumer impacted</div>
      <div class="risk-cell med">MEDIUM</div>
      <div class="risk-cell med">MEDIUM</div>
      <div class="risk-cell low">LOW</div>
    </div>
  </div>
  <h3 style="margin-top: 48px;">Lessons Learned</h3>
  <div class="lessons">
    <div class="lesson">
      <div class="lesson-id">LL-1</div>
      <div><div class="lesson-text">Any component that must survive reboots needs OS-level service registration. Asymmetric reliability (cloudflared=service, PM2=user) is a single point of failure.</div><div class="lesson-cat">Architecture</div></div>
    </div>
    <div class="lesson">
      <div class="lesson-id">LL-2</div>
      <div><div class="lesson-text">Internal health monitors create a circular dependency — they can't detect that THEY are down. External monitoring is mandatory.</div><div class="lesson-cat">Monitoring</div></div>
    </div>
    <div class="lesson">
      <div class="lesson-id">LL-3</div>
      <div><div class="lesson-text">ChatGPT served as an accidental canary. Production integrations need dedicated monitoring, not accidental detection.</div><div class="lesson-cat">Process</div></div>
    </div>
    <div class="lesson">
      <div class="lesson-id">LL-4</div>
      <div><div class="lesson-text">EADDRINUSE on restart = stale processes from manual npm start. Enforce: all production runs through PM2 only.</div><div class="lesson-cat">Operations</div></div>
    </div>
    <div class="lesson">
      <div class="lesson-id">LL-5</div>
      <div><div class="lesson-text">A 2-day outage with zero alerts is unacceptable for a system with external API consumers.</div><div class="lesson-cat">Risk</div></div>
    </div>
  </div>
</div>

<!-- SLIDE 10: Sign-Off -->
<div class="slide" data-slide="10 / 10" style="justify-content: center; align-items: center; text-align: center;">
  <div class="slide-logo">MARKET DATA BRIDGE</div>
  <h1>Sign-Off</h1>
  <p class="subtitle">RCA-2026-02-20-001</p>
  <div style="margin-top: 48px; text-align: left; max-width: 500px;">
    <table style="font-size: 16px;">
      <tr><td style="padding: 16px; width: 200px; color: #a1a1aa;">Prepared by</td><td style="padding: 16px; font-weight: 600;">Claude Code (Agent #2)</td></tr>
      <tr><td style="padding: 16px; color: #a1a1aa;">Date</td><td style="padding: 16px; font-weight: 600;">2026-02-20</td></tr>
      <tr><td style="padding: 16px; color: #a1a1aa;">Approved by</td><td style="padding: 16px; border-bottom: 2px solid #27272a; min-width: 200px;"></td></tr>
      <tr><td style="padding: 16px; color: #a1a1aa;">Date approved</td><td style="padding: 16px; border-bottom: 2px solid #27272a;"></td></tr>
      <tr><td style="padding: 16px; color: #a1a1aa;">Next review</td><td style="padding: 16px; font-weight: 600;">2026-02-24</td></tr>
    </table>
  </div>
  <p style="margin-top: 64px; color: #52525b; font-size: 12px;">Document ID: RCA-2026-02-20-001 | Classification: Internal | Retention: Permanent</p>
</div>

</body>
</html>
